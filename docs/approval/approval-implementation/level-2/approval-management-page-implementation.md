# 承認管理ページ実装計画書

## 概要

承認管理ページは、承認フローシステムの**設定管理専用画面**です。システム管理者が承認フローの設定・管理を行うための管理画面であり、通常の承認操作は各業務機能（見積管理、予算管理、発注管理など）で行います。

### 役割の明確化

- **承認管理ページ**: 承認フローの設定・管理（システム管理者向け）
- **業務機能ページ**: 承認依頼の作成・承認操作（一般ユーザー向け）

### 利用権限

- **対象ユーザー**: システム管理者、承認フロー管理権限を持つユーザー
- **権限チェック**: `approval.flow.manage` 権限が必要
- **アクセス制御**: 権限のないユーザーはアクセス不可

## 技術スタック

- **フレームワーク**: Next.js 14 (App Router)
- **UI ライブラリ**: Shadcn/ui + TanStack Table v8
- **状態管理**: TanStack Query v5 + Redux Toolkit v2.8.2
- **型安全性**: TypeScript 5 (strict mode)
- **スタイリング**: Tailwind CSS v4

## ページ構成

### 1. メインページ構造

```
/approvals (承認管理 - 設定管理専用)
├── タブナビゲーション
│   ├── 承認フロー設定
│   └── 承認フローテンプレート
└── 各タブのコンテンツ
```

### 2. タブ構成

#### 2.1 承認フロー設定タブ
- **目的**: 承認フローの作成・編集・管理（システム管理者向け）
- **主要機能**:
  - 承認フロー一覧表示
  - 承認フロー作成・編集
  - 承認フロー複製・削除
  - 承認フロー有効/無効切り替え
  - 承認フロー詳細表示
  - 承認フロー条件設定
  - 承認者設定

#### 2.2 承認フローテンプレートタブ
- **目的**: 承認フローテンプレートの管理
- **主要機能**:
  - テンプレート一覧表示
  - テンプレート作成・編集
  - テンプレートから承認フロー作成
  - テンプレート複製・削除



## まとめ

承認管理ページは、承認フローシステムの**設定管理専用画面**として、システム管理者が効率的に承認フローを管理できる重要な機能です。新しいJSONカラム設計に基づいて、以下の特徴を持つ実装を行います：

### 主要な特徴

1. **設定管理専用**: 承認フローの設定・管理に特化（承認操作は各業務機能で実行）
2. **権限ベースアクセス**: システム管理者のみがアクセス可能
3. **統合的な管理**: 承認フロー設定、テンプレート管理を一つの画面で管理
4. **直感的なUI**: タブベースのナビゲーションで機能を整理
5. **高性能**: 仮想化スクロール、メモ化、デバウンス検索による最適化
6. **アクセシビリティ**: キーボードナビゲーション、スクリーンリーダー対応
7. **レスポンシブ**: モバイル・タブレット・デスクトップ対応
8. **型安全性**: TypeScriptによる厳密な型定義
9. **テスト**: ユニットテスト・統合テストによる品質保証

### 業務フローとの分離

- **承認管理ページ**: 承認フローの設定・管理（システム管理者向け）
- **業務機能ページ**: 承認依頼の作成・承認操作（一般ユーザー向け）
  - 見積管理ページでの見積承認
  - 予算管理ページでの予算承認
  - 発注管理ページでの発注承認
  - 出来高管理ページでの出来高承認
  - 支払管理ページでの支払承認

この実装により、システム管理者は効率的に承認フローを設定・管理でき、一般ユーザーは各業務機能で直感的に承認操作を行えるようになります。
